<VirtualHost *:80>
  ServerName SERVERNAME
  Redirect 301 / https://SERVERNAME/
  
</VirtualHost>

<VirtualHost *:443>

  ServerName SERVERNAME

  SSLEngine on
  SSLCertificateFile    /certs/cert
  SSLCertificateKeyFile /certs/key
  SSLCertificateChainFile /certs/chain
  SSLHonorCipherOrder on
  SSLProtocol All -SSLv2 -SSLv3
  SSLCipherSuite ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES128-SHA256:DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA:!AES256-GCM-SHA384:!AES128-GCM-SHA256:!AES256-SHA256:!AES128-SHA256:!aNULL:!eNULL:!EXPORT:!CAMELLIA:!DES:!MD5:!PSK:!RC4

  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"

  # Keeweb
  Header always set Access-Control-Allow-Origin "*"
  Header always set Access-Control-Allow-Headers "origin, content-type, cache-control, accept, authorization, if-match, destination, overwrite"
  Header always set Access-Control-Expose-Headers "ETag"
  Header always set Access-Control-Allow-Methods "GET, HEAD, POST, PUT, OPTIONS, MOVE, DELETE, COPY, LOCK, UNLOCK"
  Header always set Access-Control-Allow-Credentials "true"

  RewriteEngine on
  RewriteCond %{REQUEST_METHOD} OPTIONS
  RewriteRule ^(.*)$ blank.html [R=200,L,E=HTTP_ORIGIN:%{HTTP:ORIGIN}]
  # /Keeweb

  IncludeOptional blocklists/*.conf
  
  RedirectMatch ^/$ /nextcloud/

	Alias /nextcloud "/var/www/html/nextcloud/"

	<Directory /var/www/html/nextcloud/>
	  Options +FollowSymlinks -Indexes
	  AllowOverride All

	 <IfModule mod_dav.c>
	  Dav off
	 </IfModule>

	 SetEnv HOME /var/www/html/nextcloud
	 SetEnv HTTP_HOME /var/www/html/nextcloud

	</Directory>

</VirtualHost>
